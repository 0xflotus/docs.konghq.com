<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/Article">
  

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Load Balancing Reference - v0.34-x | Kong - Open-Source API Management and Microservice Management</title>
  <meta name="description" content="Secure, Manage &amp; Extend your APIs or Microservices with plugins for authentication, logging, rate-limiting, transformations and more." />
  <meta name="author" content="KongHQ" />
  <meta property="og:title" content="Open-Source API Management and Microservice Management" />
  <meta property="og:site_name" content="Kong" />
  <!-- use share link for facebook -->
  <meta property="og:url" content="https://docs.konghq.com" />
  <meta property="og:description" content="Secure, Manage &amp; Extend your APIs or Microservices with plugins for authentication, logging, rate-limiting, transformations and more." />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="en_US" />
  <meta
    property="og:image"
    content="https://docs.konghq.com/assets/images/share.png"
  />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@thekonginc" />
  <meta name="twitter:creator" content="@thekonginc" />
  <meta name="twitter:url" content="https://docs.konghq.com" />
  <meta name="twitter:description" content="Secure, Manage &amp; Extend your APIs or Microservices with plugins for authentication, logging, rate-limiting, transformations and more." />
  <meta
    name="twitter:image"
    content="https://docs.konghq.com/assets/images/share.png"
  />
  <meta property="fb:admins" content="227304446" />
  <meta property="fb:admins" content="576641408" />
  <meta
    name="google-site-verification"
    content="CrU3zp02dNKTe8NSAipL4NCPkrIjDXG8fViTZ-MIzP4"
  />
  <link
    rel="stylesheet"
    href="https://use.fontawesome.com/releases/v5.4.1/css/all.css"
    integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz"
    crossorigin="anonymous"
  />

  <!-- New Relic -->
  <script type="text/javascript">
/* eslint-disable */
window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var o=e[n]={exports:{}};t[n][0].call(o.exports,function(e){var o=t[n][1][e];return r(o||e)},o,o.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,n){function r(t){try{c.console&&console.log(t)}catch(e){}}var o,i=t("ee"),a=t(20),c={};try{o=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(c.console=!0,o.indexOf("dev")!==-1&&(c.dev=!0),o.indexOf("nr_dev")!==-1&&(c.nrDev=!0))}catch(s){}c.nrDev&&i.on("internal-error",function(t){r(t.stack)}),c.dev&&i.on("fn-err",function(t,e,n){r(n.stack)}),c.dev&&(r("NR AGENT IN DEVELOPMENT MODE"),r("flags: "+a(c,function(t,e){return t}).join(", ")))},{}],2:[function(t,e,n){function r(t,e,n,r,c){try{h?h-=1:o(c||new UncaughtException(t,e,n),!0)}catch(f){try{i("ierr",[f,s.now(),!0])}catch(d){}}return"function"==typeof u&&u.apply(this,a(arguments))}function UncaughtException(t,e,n){this.message=t||"Uncaught error with no additional information",this.sourceURL=e,this.line=n}function o(t,e){var n=e?null:s.now();i("err",[t,n])}var i=t("handle"),a=t(21),c=t("ee"),s=t("loader"),f=t("gos"),u=window.onerror,d=!1,p="nr@seenError",h=0;s.features.err=!0,t(1),window.onerror=r;try{throw new Error}catch(l){"stack"in l&&(t(13),t(12),"addEventListener"in window&&t(6),s.xhrWrappable&&t(14),d=!0)}c.on("fn-start",function(t,e,n){d&&(h+=1)}),c.on("fn-err",function(t,e,n){d&&!n[p]&&(f(n,p,function(){return!0}),this.thrown=!0,o(n))}),c.on("fn-end",function(){d&&!this.thrown&&h>0&&(h-=1)}),c.on("internal-error",function(t){i("ierr",[t,s.now(),!0])})},{}],3:[function(t,e,n){t("loader").features.ins=!0},{}],4:[function(t,e,n){function r(){M++,S=y.hash,this[u]=b.now()}function o(){M--,y.hash!==S&&i(0,!0);var t=b.now();this[l]=~~this[l]+t-this[u],this[d]=t}function i(t,e){E.emit("newURL",[""+y,e])}function a(t,e){t.on(e,function(){this[e]=b.now()})}var c="-start",s="-end",f="-body",u="fn"+c,d="fn"+s,p="cb"+c,h="cb"+s,l="jsTime",m="fetch",v="addEventListener",w=window,y=w.location,b=t("loader");if(w[v]&&b.xhrWrappable){var g=t(10),x=t(11),E=t(8),P=t(6),O=t(13),R=t(7),T=t(14),L=t(9),j=t("ee"),N=j.get("tracer");t(15),b.features.spa=!0;var S,M=0;j.on(u,r),j.on(p,r),j.on(d,o),j.on(h,o),j.buffer([u,d,"xhr-done","xhr-resolved"]),P.buffer([u]),O.buffer(["setTimeout"+s,"clearTimeout"+c,u]),T.buffer([u,"new-xhr","send-xhr"+c]),R.buffer([m+c,m+"-done",m+f+c,m+f+s]),E.buffer(["newURL"]),g.buffer([u]),x.buffer(["propagate",p,h,"executor-err","resolve"+c]),N.buffer([u,"no-"+u]),L.buffer(["new-jsonp","cb-start","jsonp-error","jsonp-end"]),a(T,"send-xhr"+c),a(j,"xhr-resolved"),a(j,"xhr-done"),a(R,m+c),a(R,m+"-done"),a(L,"new-jsonp"),a(L,"jsonp-end"),a(L,"cb-start"),E.on("pushState-end",i),E.on("replaceState-end",i),w[v]("hashchange",i,!0),w[v]("load",i,!0),w[v]("popstate",function(){i(0,M>1)},!0)}},{}],5:[function(t,e,n){function r(t){}if(window.performance&&window.performance.timing&&window.performance.getEntriesByType){var o=t("ee"),i=t("handle"),a=t(13),c=t(12),s="learResourceTimings",f="addEventListener",u="resourcetimingbufferfull",d="bstResource",p="resource",h="-start",l="-end",m="fn"+h,v="fn"+l,w="bstTimer",y="pushState",b=t("loader");b.features.stn=!0,t(8);var g=NREUM.o.EV;o.on(m,function(t,e){var n=t[0];n instanceof g&&(this.bstStart=b.now())}),o.on(v,function(t,e){var n=t[0];n instanceof g&&i("bst",[n,e,this.bstStart,b.now()])}),a.on(m,function(t,e,n){this.bstStart=b.now(),this.bstType=n}),a.on(v,function(t,e){i(w,[e,this.bstStart,b.now(),this.bstType])}),c.on(m,function(){this.bstStart=b.now()}),c.on(v,function(t,e){i(w,[e,this.bstStart,b.now(),"requestAnimationFrame"])}),o.on(y+h,function(t){this.time=b.now(),this.startPath=location.pathname+location.hash}),o.on(y+l,function(t){i("bstHist",[location.pathname+location.hash,this.startPath,this.time])}),f in window.performance&&(window.performance["c"+s]?window.performance[f](u,function(t){i(d,[window.performance.getEntriesByType(p)]),window.performance["c"+s]()},!1):window.performance[f]("webkit"+u,function(t){i(d,[window.performance.getEntriesByType(p)]),window.performance["webkitC"+s]()},!1)),document[f]("scroll",r,{passive:!0}),document[f]("keypress",r,!1),document[f]("click",r,!1)}},{}],6:[function(t,e,n){function r(t){for(var e=t;e&&!e.hasOwnProperty(u);)e=Object.getPrototypeOf(e);e&&o(e)}function o(t){c.inPlace(t,[u,d],"-",i)}function i(t,e){return t[1]}var a=t("ee").get("events"),c=t(23)(a,!0),s=t("gos"),f=XMLHttpRequest,u="addEventListener",d="removeEventListener";e.exports=a,"getPrototypeOf"in Object?(r(document),r(window),r(f.prototype)):f.prototype.hasOwnProperty(u)&&(o(window),o(f.prototype)),a.on(u+"-start",function(t,e){var n=t[1],r=s(n,"nr@wrapped",function(){function t(){if("function"==typeof n.handleEvent)return n.handleEvent.apply(n,arguments)}var e={object:t,"function":n}[typeof n];return e?c(e,"fn-",null,e.name||"anonymous"):n});this.wrapped=t[1]=r}),a.on(d+"-start",function(t){t[1]=this.wrapped||t[1]})},{}],7:[function(t,e,n){function r(t,e,n){var r=t[e];"function"==typeof r&&(t[e]=function(){var t=r.apply(this,arguments);return o.emit(n+"start",arguments,t),t.then(function(e){return o.emit(n+"end",[null,e],t),e},function(e){throw o.emit(n+"end",[e],t),e})})}var o=t("ee").get("fetch"),i=t(20);e.exports=o;var a=window,c="fetch-",s=c+"body-",f=["arrayBuffer","blob","json","text","formData"],u=a.Request,d=a.Response,p=a.fetch,h="prototype";u&&d&&p&&(i(f,function(t,e){r(u[h],e,s),r(d[h],e,s)}),r(a,"fetch",c),o.on(c+"end",function(t,e){var n=this;e?e.clone().arrayBuffer().then(function(t){n.rxSize=t.byteLength,o.emit(c+"done",[null,e],n)}):o.emit(c+"done",[t],n)}))},{}],8:[function(t,e,n){var r=t("ee").get("history"),o=t(23)(r);e.exports=r,o.inPlace(window.history,["pushState","replaceState"],"-")},{}],9:[function(t,e,n){function r(t){function e(){s.emit("jsonp-end",[],p),t.removeEventListener("load",e,!1),t.removeEventListener("error",n,!1)}function n(){s.emit("jsonp-error",[],p),s.emit("jsonp-end",[],p),t.removeEventListener("load",e,!1),t.removeEventListener("error",n,!1)}var r=t&&"string"==typeof t.nodeName&&"script"===t.nodeName.toLowerCase();if(r){var o="function"==typeof t.addEventListener;if(o){var a=i(t.src);if(a){var u=c(a),d="function"==typeof u.parent[u.key];if(d){var p={};f.inPlace(u.parent,[u.key],"cb-",p),t.addEventListener("load",e,!1),t.addEventListener("error",n,!1),s.emit("new-jsonp",[t.src],p)}}}}}function o(){return"addEventListener"in window}function i(t){var e=t.match(u);return e?e[1]:null}function a(t,e){var n=t.match(p),r=n[1],o=n[3];return o?a(o,e[r]):e[r]}function c(t){var e=t.match(d);return e&&e.length>=3?{key:e[2],parent:a(e[1],window)}:{key:t,parent:window}}var s=t("ee").get("jsonp"),f=t(23)(s);if(e.exports=s,o()){var u=/[?&](?:callback|cb)=([^&#]+)/,d=/(.*)\.([^.]+)/,p=/^(\w+)(\.|$)(.*)$/,h=["appendChild","insertBefore","replaceChild"];f.inPlace(HTMLElement.prototype,h,"dom-"),f.inPlace(HTMLHeadElement.prototype,h,"dom-"),f.inPlace(HTMLBodyElement.prototype,h,"dom-"),s.on("dom-start",function(t){r(t[0])})}},{}],10:[function(t,e,n){var r=t("ee").get("mutation"),o=t(23)(r),i=NREUM.o.MO;e.exports=r,i&&(window.MutationObserver=function(t){return this instanceof i?new i(o(t,"fn-")):i.apply(this,arguments)},MutationObserver.prototype=i.prototype)},{}],11:[function(t,e,n){function r(t){var e=a.context(),n=c(t,"executor-",e),r=new f(n);return a.context(r).getCtx=function(){return e},a.emit("new-promise",[r,e],e),r}function o(t,e){return e}var i=t(23),a=t("ee").get("promise"),c=i(a),s=t(20),f=NREUM.o.PR;e.exports=a,f&&(window.Promise=r,["all","race"].forEach(function(t){var e=f[t];f[t]=function(n){function r(t){return function(){a.emit("propagate",[null,!o],i),o=o||!t}}var o=!1;s(n,function(e,n){Promise.resolve(n).then(r("all"===t),r(!1))});var i=e.apply(f,arguments),c=f.resolve(i);return c}}),["resolve","reject"].forEach(function(t){var e=f[t];f[t]=function(t){var n=e.apply(f,arguments);return t!==n&&a.emit("propagate",[t,!0],n),n}}),f.prototype["catch"]=function(t){return this.then(null,t)},f.prototype=Object.create(f.prototype,{constructor:{value:r}}),s(Object.getOwnPropertyNames(f),function(t,e){try{r[e]=f[e]}catch(n){}}),a.on("executor-start",function(t){t[0]=c(t[0],"resolve-",this),t[1]=c(t[1],"resolve-",this)}),a.on("executor-err",function(t,e,n){t[1](n)}),c.inPlace(f.prototype,["then"],"then-",o),a.on("then-start",function(t,e){this.promise=e,t[0]=c(t[0],"cb-",this),t[1]=c(t[1],"cb-",this)}),a.on("then-end",function(t,e,n){this.nextPromise=n;var r=this.promise;a.emit("propagate",[r,!0],n)}),a.on("cb-end",function(t,e,n){a.emit("propagate",[n,!0],this.nextPromise)}),a.on("propagate",function(t,e,n){this.getCtx&&!e||(this.getCtx=function(){if(t instanceof Promise)var e=a.context(t);return e&&e.getCtx?e.getCtx():this})}),r.toString=function(){return""+f})},{}],12:[function(t,e,n){var r=t("ee").get("raf"),o=t(23)(r),i="equestAnimationFrame";e.exports=r,o.inPlace(window,["r"+i,"mozR"+i,"webkitR"+i,"msR"+i],"raf-"),r.on("raf-start",function(t){t[0]=o(t[0],"fn-")})},{}],13:[function(t,e,n){function r(t,e,n){t[0]=a(t[0],"fn-",null,n)}function o(t,e,n){this.method=n,this.timerDuration=isNaN(t[1])?0:+t[1],t[0]=a(t[0],"fn-",this,n)}var i=t("ee").get("timer"),a=t(23)(i),c="setTimeout",s="setInterval",f="clearTimeout",u="-start",d="-";e.exports=i,a.inPlace(window,[c,"setImmediate"],c+d),a.inPlace(window,[s],s+d),a.inPlace(window,[f,"clearImmediate"],f+d),i.on(s+u,r),i.on(c+u,o)},{}],14:[function(t,e,n){function r(t,e){d.inPlace(e,["onreadystatechange"],"fn-",c)}function o(){var t=this,e=u.context(t);t.readyState>3&&!e.resolved&&(e.resolved=!0,u.emit("xhr-resolved",[],t)),d.inPlace(t,y,"fn-",c)}function i(t){b.push(t),l&&(x?x.then(a):v?v(a):(E=-E,P.data=E))}function a(){for(var t=0;t<b.length;t++)r([],b[t]);b.length&&(b=[])}function c(t,e){return e}function s(t,e){for(var n in t)e[n]=t[n];return e}t(6);var f=t("ee"),u=f.get("xhr"),d=t(23)(u),p=NREUM.o,h=p.XHR,l=p.MO,m=p.PR,v=p.SI,w="readystatechange",y=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],b=[];e.exports=u;var g=window.XMLHttpRequest=function(t){var e=new h(t);try{u.emit("new-xhr",[e],e),e.addEventListener(w,o,!1)}catch(n){try{u.emit("internal-error",[n])}catch(r){}}return e};if(s(h,g),g.prototype=h.prototype,d.inPlace(g.prototype,["open","send"],"-xhr-",c),u.on("send-xhr-start",function(t,e){r(t,e),i(e)}),u.on("open-xhr-start",r),l){var x=m&&m.resolve();if(!v&&!m){var E=1,P=document.createTextNode(E);new l(a).observe(P,{characterData:!0})}}else f.on("fn-end",function(t){t[0]&&t[0].type===w||a()})},{}],15:[function(t,e,n){function r(t){var e=this.params,n=this.metrics;if(!this.ended){this.ended=!0;for(var r=0;r<d;r++)t.removeEventListener(u[r],this.listener,!1);if(!e.aborted){if(n.duration=a.now()-this.startTime,4===t.readyState){e.status=t.status;var i=o(t,this.lastSize);if(i&&(n.rxSize=i),this.sameOrigin){var s=t.getResponseHeader("X-NewRelic-App-Data");s&&(e.cat=s.split(", ").pop())}}else e.status=0;n.cbTime=this.cbTime,f.emit("xhr-done",[t],t),c("xhr",[e,n,this.startTime])}}}function o(t,e){var n=t.responseType;if("json"===n&&null!==e)return e;var r="arraybuffer"===n||"blob"===n||"json"===n?t.response:t.responseText;return l(r)}function i(t,e){var n=s(e),r=t.params;r.host=n.hostname+":"+n.port,r.pathname=n.pathname,t.sameOrigin=n.sameOrigin}var a=t("loader");if(a.xhrWrappable){var c=t("handle"),s=t(16),f=t("ee"),u=["load","error","abort","timeout"],d=u.length,p=t("id"),h=t(19),l=t(18),m=window.XMLHttpRequest;a.features.xhr=!0,t(14),f.on("new-xhr",function(t){var e=this;e.totalCbs=0,e.called=0,e.cbTime=0,e.end=r,e.ended=!1,e.xhrGuids={},e.lastSize=null,h&&(h>34||h<10)||window.opera||t.addEventListener("progress",function(t){e.lastSize=t.loaded},!1)}),f.on("open-xhr-start",function(t){this.params={method:t[0]},i(this,t[1]),this.metrics={}}),f.on("open-xhr-end",function(t,e){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&e.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid)}),f.on("send-xhr-start",function(t,e){var n=this.metrics,r=t[0],o=this;if(n&&r){var i=l(r);i&&(n.txSize=i)}this.startTime=a.now(),this.listener=function(t){try{"abort"===t.type&&(o.params.aborted=!0),("load"!==t.type||o.called===o.totalCbs&&(o.onloadCalled||"function"!=typeof e.onload))&&o.end(e)}catch(n){try{f.emit("internal-error",[n])}catch(r){}}};for(var c=0;c<d;c++)e.addEventListener(u[c],this.listener,!1)}),f.on("xhr-cb-time",function(t,e,n){this.cbTime+=t,e?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof n.onload||this.end(n)}),f.on("xhr-load-added",function(t,e){var n=""+p(t)+!!e;this.xhrGuids&&!this.xhrGuids[n]&&(this.xhrGuids[n]=!0,this.totalCbs+=1)}),f.on("xhr-load-removed",function(t,e){var n=""+p(t)+!!e;this.xhrGuids&&this.xhrGuids[n]&&(delete this.xhrGuids[n],this.totalCbs-=1)}),f.on("addEventListener-end",function(t,e){e instanceof m&&"load"===t[0]&&f.emit("xhr-load-added",[t[1],t[2]],e)}),f.on("removeEventListener-end",function(t,e){e instanceof m&&"load"===t[0]&&f.emit("xhr-load-removed",[t[1],t[2]],e)}),f.on("fn-start",function(t,e,n){e instanceof m&&("onload"===n&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=a.now()))}),f.on("fn-end",function(t,e){this.xhrCbStart&&f.emit("xhr-cb-time",[a.now()-this.xhrCbStart,this.onload,e],e)})}},{}],16:[function(t,e,n){e.exports=function(t){var e=document.createElement("a"),n=window.location,r={};e.href=t,r.port=e.port;var o=e.href.split("://");!r.port&&o[1]&&(r.port=o[1].split("/")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=e.hostname||n.hostname,r.pathname=e.pathname,r.protocol=o[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname);var i=!e.protocol||":"===e.protocol||e.protocol===n.protocol,a=e.hostname===document.domain&&e.port===n.port;return r.sameOrigin=i&&(!e.hostname||a),r}},{}],17:[function(t,e,n){function r(){}function o(t,e,n){return function(){return i(t,[f.now()].concat(c(arguments)),e?null:this,n),e?void 0:this}}var i=t("handle"),a=t(20),c=t(21),s=t("ee").get("tracer"),f=t("loader"),u=NREUM;"undefined"==typeof window.newrelic&&(newrelic=u);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],p="api-",h=p+"ixn-";a(d,function(t,e){u[e]=o(p+e,!0,"api")}),u.addPageAction=o(p+"addPageAction",!0),u.setCurrentRouteName=o(p+"routeName",!0),e.exports=newrelic,u.interaction=function(){return(new r).get()};var l=r.prototype={createTracer:function(t,e){var n={},r=this,o="function"==typeof e;return i(h+"tracer",[f.now(),t,n],r),function(){if(s.emit((o?"":"no-")+"fn-start",[f.now(),r,o],n),o)try{return e.apply(this,arguments)}catch(t){throw s.emit("fn-err",[arguments,this,t],n),t}finally{s.emit("fn-end",[f.now()],n)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,e){l[e]=o(h+e)}),newrelic.noticeError=function(t){"string"==typeof t&&(t=new Error(t)),i("err",[t,f.now()])}},{}],18:[function(t,e,n){e.exports=function(t){if("string"==typeof t&&t.length)return t.length;if("object"==typeof t){if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if(!("undefined"!=typeof FormData&&t instanceof FormData))try{return JSON.stringify(t).length}catch(e){return}}}},{}],19:[function(t,e,n){var r=0,o=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);o&&(r=+o[1]),e.exports=r},{}],20:[function(t,e,n){function r(t,e){var n=[],r="",i=0;for(r in t)o.call(t,r)&&(n[i]=e(r,t[r]),i+=1);return n}var o=Object.prototype.hasOwnProperty;e.exports=r},{}],21:[function(t,e,n){function r(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,o=n-e||0,i=Array(o<0?0:o);++r<o;)i[r]=t[e+r];return i}e.exports=r},{}],22:[function(t,e,n){e.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],23:[function(t,e,n){function r(t){return!(t&&t instanceof Function&&t.apply&&!t[a])}var o=t("ee"),i=t(21),a="nr@original",c=Object.prototype.hasOwnProperty,s=!1;e.exports=function(t,e){function n(t,e,n,o){function nrWrapper(){var r,a,c,s;try{a=this,r=i(arguments),c="function"==typeof n?n(r,a):n||{}}catch(f){p([f,"",[r,a,o],c])}u(e+"start",[r,a,o],c);try{return s=t.apply(a,r)}catch(d){throw u(e+"err",[r,a,d],c),d}finally{u(e+"end",[r,a,s],c)}}return r(t)?t:(e||(e=""),nrWrapper[a]=t,d(t,nrWrapper),nrWrapper)}function f(t,e,o,i){o||(o="");var a,c,s,f="-"===o.charAt(0);for(s=0;s<e.length;s++)c=e[s],a=t[c],r(a)||(t[c]=n(a,f?c+o:o,i,c))}function u(n,r,o){if(!s||e){var i=s;s=!0;try{t.emit(n,r,o,e)}catch(a){p([a,n,r,o])}s=i}}function d(t,e){if(Object.defineProperty&&Object.keys)try{var n=Object.keys(t);return n.forEach(function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){return t[n]=e,e}})}),e}catch(r){p([r])}for(var o in t)c.call(t,o)&&(e[o]=t[o]);return e}function p(e){try{t.emit("internal-error",e)}catch(n){}}return t||(t=o),n.inPlace=f,n.flag=a,n}},{}],ee:[function(t,e,n){function r(){}function o(t){function e(t){return t&&t instanceof r?t:t?s(t,c,i):i()}function n(n,r,o,i){if(!p.aborted||i){t&&t(n,r,o);for(var a=e(o),c=l(n),s=c.length,f=0;f<s;f++)c[f].apply(a,r);var d=u[y[n]];return d&&d.push([b,n,r,a]),a}}function h(t,e){w[t]=l(t).concat(e)}function l(t){return w[t]||[]}function m(t){return d[t]=d[t]||o(n)}function v(t,e){f(t,function(t,n){e=e||"feature",y[n]=e,e in u||(u[e]=[])})}var w={},y={},b={on:h,emit:n,get:m,listeners:l,context:e,buffer:v,abort:a,aborted:!1};return b}function i(){return new r}function a(){(u.api||u.feature)&&(p.aborted=!0,u=p.backlog={})}var c="nr@context",s=t("gos"),f=t(20),u={},d={},p=e.exports=o();p.backlog=u},{}],gos:[function(t,e,n){function r(t,e,n){if(o.call(t,e))return t[e];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return t[e]=r,r}var o=Object.prototype.hasOwnProperty;e.exports=r},{}],handle:[function(t,e,n){function r(t,e,n,r){o.buffer([t],r),o.emit(t,e,n)}var o=t("ee").get("handle");e.exports=r,r.ee=o},{}],id:[function(t,e,n){function r(t){var e=typeof t;return!t||"object"!==e&&"function"!==e?-1:t===window?0:a(t,i,function(){return o++})}var o=1,i="nr@id",a=t("gos");e.exports=r},{}],loader:[function(t,e,n){function r(){if(!x++){var t=g.info=NREUM.info,e=p.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&e))return u.abort();f(y,function(e,n){t[e]||(t[e]=n)}),s("mark",["onload",a()+g.offset],null,"api");var n=p.createElement("script");n.src="https://"+t.agent,e.parentNode.insertBefore(n,e)}}function o(){"complete"===p.readyState&&i()}function i(){s("mark",["domContent",a()+g.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(c=Math.max((new Date).getTime(),c))-g.offset}var c=(new Date).getTime(),s=t("handle"),f=t(20),u=t("ee"),d=window,p=d.document,h="addEventListener",l="attachEvent",m=d.XMLHttpRequest,v=m&&m.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:m,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var w=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-spa-1071.min.js"},b=m&&v&&v[h]&&!/CriOS/.test(navigator.userAgent),g=e.exports={offset:c,now:a,origin:w,features:{},xhrWrappable:b};t(17),p[h]?(p[h]("DOMContentLoaded",i,!1),d[h]("load",r,!1)):(p[l]("onreadystatechange",o),d[l]("onload",r)),s("mark",["firstbyte",c],null,"api");var x=0,E=t(22)},{}]},{},["loader",2,15,5,3,4]);
;NREUM.info={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",licenseKey:"13e44ec848",applicationID:"187820761",sa:1}
</script>


  <!-- FullStory -->
  <!-- <script>
/* eslint-disable */
window['_fs_debug'] = false;
window['_fs_host'] = 'fullstory.com';
window['_fs_org'] = '7JS2S';
window['_fs_namespace'] = 'FS';
(function(m,n,e,t,l,o,g,y){
    if (e in m) {if(m.console && m.console.log) { m.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].');} return;}
    g=m[e]=function(a,b){g.q?g.q.push([a,b]):g._api(a,b);};g.q=[];
    o=n.createElement(t);o.async=1;o.src='https://'+_fs_host+'/s/fs.js';
    y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);
    g.identify=function(i,v){g(l,{uid:i});if(v)g(l,v)};g.setUserVars=function(v){g(l,v)};g.event=function(i,v){g('event',{n:i,p:v})};
    g.shutdown=function(){g("rec",!1)};g.restart=function(){g("rec",!0)};
    g.consent=function(a){g("consent",!arguments.length||a)};
    g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;g(o,v)};
    g.clearUserCookie=function(){};
})(window,document,window['_fs_namespace'],'script','user');
</script>
 -->

  <!-- Delighted -->
  <script type="text/javascript">
/* eslint-disable */
  !function(e,t,r,n,a){if(!e[a]){for(var i=e[a]=[],s=0;s<r.length;s++){var c=r[s];i[c]=i[c]||function(e){return function(){var t=Array.prototype.slice.call(arguments);i.push([e,t])}}(c)}i.SNIPPET_VERSION="1.0.1";var o=t.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://d2yyd1h5u9mauk.cloudfront.net/integrations/web/v1/library/"+n+"/"+a+".js";var u=t.getElementsByTagName("script")[0];u.parentNode.insertBefore(o,u)}}(window,document,["survey","reset","config","init","set","get","event","identify","track","page","screen","group","alias"],"Mvwmq6n6DhInaFYu","delighted");

  delighted.survey();
</script>


  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "name": "KongHQ",
      "url": "https://docs.konghq.com",
      "logo": "https://docs.konghq.com/assets/images/logo.png",
      "sameAs": [
        "https://www.facebook.com/konginc",
        "https://twitter.com/thekonginc",
        "https://plus.google.com/+mashape"
      ]
    }
  </script>

  <!-- Preload assets -->
  <link rel="dns-prefetch" href="//cloud.typography.com" />
  <link
    href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700"
    rel="stylesheet"
  />
  <link rel="dns-prefetch" href="//dev.visualwebsiteoptimizer.com" />
  <link rel="dns-prefetch" href="//cdn.segment.com" />

  <!-- Recaptcha -->
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>

  <!-- ##gulp-resource-hints## -->

  <link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico" />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"
  />
  <link
    rel="stylesheet"
    href="/assets/styles.css?v=1566241358"
  />
  
</head>

<!-- Kong Cookie Policy -->
<div class="cookie-policy-container">
  <p>In order to give you better service we use cookies. By continuing to use our website, you agree to the use of cookies as described in our <a href=" https://konghq.com/cookie-policy/">Cookie Policy</a>
  <button class="cookie-policy-accept btn button" type="submit">I Agree</button>
</div>



  <body
    id=""
    
    data-spy="scroll"
    data-target="#scroll-sidebar"
    data-offset="350"
  >
    <header class="navbar navbar-inverse navbar-toggleable-lg kong-navbar flex-row align-items-center fixed-top">
  <div class="container d-flex">
    <nav id="fullNav" class="col justify-content-md-end kong-navbar_nav">
      <ul class="navbar-nav left">
        <li class="navbar-item kong-navbar-dropdown kong-navbar-dropdown--columns">
          <a class="nav-link">Products</a>
          <div class="list-group products">
            <div class="list-group-item flex-row flex-nowrap mega row">
                <div class="kong-navbar-dropdown_column col-md-4 offerings">
                    <h5 class="list-group-item-action">Offerings</h5>
                    <a href="http://konghq.com/kong/" class="list-group-item-action">
                      <img src="/assets/images/nav/icn-kong.svg" alt="Kong">
                      <div>Kong
                        <p class="mb-1 mini">The blazingly fast open source microservices API gateway.</p>
                      </div>
                    </a>
                    <a href="http://konghq.com/kong-enterprise/" class="list-group-item-action">
                      <img src="/assets/images/nav/icn-kong-enterprise.svg" alt="Kong Enterprise">
                      <div>Kong Enterprise
                      <p class="mb-1 mini">The next-generation API platform built on top of Kong.</p>
                      </div>
                    </a>
                    <a href="http://konghq.com/cloud" class="list-group-item-action">
                      <img src="/assets/images/nav/icn-kong-cloud.svg" alt="Kong Cloud">
                      <div>Kong Cloud
                      <p class="mb-1 mini">Kong Enterprise innovation delivered at cloud speed.</p>
                      </div>
                    </a>
                  </div>
              <div class="kong-navbar-dropdown_column col-md-8 dark">
                <h5 class="list-group-item-action">Service Control Platform</h5>
                  <div class="inner-wrap">
                    <a href="http://konghq.com/products/service-control-platform" class="list-group-item-action">
                      <img src="/assets/images/nav/icn-overview.svg" alt="Overview">
                      <div>Platform Overview
                      <p class="mb-1 mini">End-to-end control of information exchange for hybrid and multi-cloud organizations.</p>
                      </div>
                    </a>
                    <a href="http://konghq.com/products/kong-manager" class="list-group-item-action">
                      <img src="/assets/images/nav/icn-manager.svg" alt="Kong Manager">
                      <div>Kong Manager
                      <p class="mb-1 mini">Elegant visual interface for monitoring and managing Kong Enterprise.</p>
                      </div>
                    </a>
                    <a href="http://konghq.com/api-dev-portal" class="list-group-item-action">
                      <img src="/assets/images/nav/icn-manager.svg" alt="Dev Portal">
                      <div>Kong Dev Portal
                      <p class="mb-1 mini">Single source of truth for a unified developer experience.</p>
                      </div>
                    </a>
                    <a href="http://konghq.com/products/kong-vitals" class="list-group-item-action">
                      <img src="/assets/images/nav/icn-vitals.svg" alt="Kong Vitals">
                      <div>Kong Vitals
                      <p class="mb-1 mini">Granular analytics to understand the health of Kong Enterprise.</p>
                      </div>
                    </a>
                    <a href="http://konghq.com/products/kong-brain" class="list-group-item-action">
                      <img src="/assets/images/nav/icn-brain.svg" alt="Kong Brain">
                      <div>Kong Brain
                      <p class="mb-1 mini">Intelligent automation to streamline service development and management.</p>
                      </div>
                    </a>
                    <a href="http://konghq.com/products/kong-immunity" class="list-group-item-action">
                      <img src="/assets/images/nav/icn-immunity.svg" alt="Kong Immunity">
                      <div>Kong Immunity
                      <p class="mb-1 mini">Advanced traffic anomaly detection to identify issues and threats.</p>
                      </div>
                    </a>
                  </div>
              </div>
            </div> <!-- list-group-item -->
          </div> <!-- list-group -->
        </li>
        <li class="navbar-item kong-navbar-dropdown kong-navbar-dropdown-small"><a class="nav-link">Solutions</a>
          <div class="list-group solutions">
          <div class="list-group-item flex-row flex-nowrap">
            <div class="list-item">
            <a href="http://konghq.com/solutions/gateway" target="blank" class="list-group-item list-group-item-action">
              <img src="/assets/images/nav/icn-apigateway.svg" alt="API Gateway">
            <div>
            API Gateway
            <p>Take control of your microservices traffic with the world's most popular API gateway.</p>
            </div>
            </a>
            </div>
            <div class="list-item">
            <a href="http://konghq.com/solutions/kubernetes-ingress" class="list-group-item list-group-item-action">
              <img src="/assets/images/nav/icn-kubernetes.svg" alt="Kubernetes Ingress">
            <div>
            Kubernetes Ingress
            <p>Own your Kubernetes cluster by extending Kong functionality as an ingress controller.</p>
            </div>
            </a>
            </div>
            <div class="list-item">
            <a href="http://konghq.com/solutions/service-mesh/" class="list-group-item list-group-item-action">
              <img src="/assets/images/nav/icn-service-mesh.svg" alt="Service Mesh">
            <div>Service Mesh
            <p>Inject Kong as a sidecar for your services to go from mess to mesh.<br><br></p>
            </div>
            </a>
            </div>
          </div>
          </div> <!-- list-group -->
        </li>
        <li class="navbar-item">
          <a href="https://docs.konghq.com/hub" class="nav-link">Plugins</a>
        </li>
    </ul>
    <a href="http://konghq.com/" class="navbar-brand col col-xl-auto">
      <img src="/assets/images/Kogo-gradient.svg" alt="Kong">
    </a>
    <ul class="navbar-nav right">
      <li class="navbar-item kong-navbar-dropdown kong-navbar-dropdown-small left-trigger"><a class="nav-link">Docs</a>
          <div class="list-group docs">
          <div class="list-group-item flex-row flex-wrap">
          <div class="kong-navbar-dropdown_column col-md-6">
            <h5 class="list-group-item-action">Get Started</h5>
            <div class="list-item">
            <a href="https://konghq.com/install" class="list-group-item list-group-item-action">
              <img src="/assets/images/nav/icn-install.svg" alt="Install">
              <div>Install
              <p>Get started with Kong now.</p>
              </div>
            </a>
            </div>
            <div class="list-item">
                <a href="https://docs.konghq.com" class="list-group-item list-group-item-action">
                  <img src="/assets/images/nav/icn-getting-started.svg" alt="Docs">
                  <div>Kong Docs + Getting Started
                  <p>Use the 5-minute quickstart and installation guide to deploy Kong now.</p>
                  </div>
                </a>
              </div>
          </div>
          <div class="kong-navbar-dropdown_column col-md-6 dark">
              <h5 class="list-group-item-action">Learn</h5>
            <div class="list-item">
            <a href="https://docs.konghq.com/enterprise" class="list-group-item list-group-item-action">
              <img src="/assets/images/nav/icn-documentation.svg" alt="Documentation">
              <div>Deploy Kong Enterprise
            <p>Use the quickstart and reference materials to launch Kong Enterprise today.</p>
              </div>
            </a>
            </div>
            <div class="list-item">
            <a href="https://docs.konghq.com/enterprise/0.35-x/admin-api/vitals/" class="list-group-item list-group-item-action">
              <img src="/assets/images/nav/icn-documentation.svg" alt="Documentation">
              <div>Master Kong Vitals
            <p>Learn how to implement Vitals and optimize it for your deployment.</p>
              </div>
            </a>
            </div>
            <div class="list-item">
            <a href="https://docs.konghq.com/enterprise/latest/developer-portal/introduction/" class="list-group-item list-group-item-action">
              <img src="/assets/images/nav/icn-documentation.svg" alt="Documentation">
              <div>Launch your Dev Portal
            <p>Learn how to create and manage your Kong Dev Portal.<br><br></p>
              </div>
            </a>
            </div>
          </div>
          </div>
          </div>
        </li>
        <li class="navbar-item kong-navbar-dropdown kong-navbar-dropdown--columns">
          <a class="nav-link">Resources</a>
          <div class="list-group resources">
            <div class="list-group-item flex-row flex-nowrap mega row">
              <div class="kong-navbar-dropdown_column col-md-3 learn">
                <h5 class="list-group-item-action">Downloads</h5>
                  <div class="inner-wrap">
                    <a href="http://konghq.com/blog" class="list-group-item-action"><img src="/assets/images/nav/icn-blog-16.svg" alt="blog">Blog</a>
                    <a href="http://konghq.com/ebooks" class="list-group-item-action"><img src="/assets/images/nav/icn-ebooks.svg" alt="ebooks">Ebooks</a>
                    <a href="http://konghq.com/webinars" class="list-group-item-action"><img src="/assets/images/nav/icn-webinars.svg" alt="webinars">Webinars</a>
                    <a href="http://konghq.com/briefs" class="list-group-item-action"><img src="/assets/images/nav/icn-briefs.svg" alt="briefs">Briefs</a>
                  </div>
              </div>
              <div class="kong-navbar-dropdown_column col-md-3">
                  <h5 class="list-group-item-action">Community</h5>
                  <div class="inner-wrap">
                  <a href="https://discuss.konghq.com/" class="list-group-item-action"><img src="/assets/images/nav/icn-kongnation-md.svg" alt="Kong Nation">Kong Nation</a>
                  <a href="https://github.com/Kong/" class="list-group-item-action"><img src="/assets/images/nav/icn-github-md.svg" alt="GitHub">GitHub</a>
                  <a href="http://konghq.com/community" class="list-group-item-action"><img src="/assets/images/nav/icn-meetups-md.svg" alt="meetups">Meetups</a>
                  <a href="http://konghq.com/kong-summit" class="list-group-item-action"><img src="/assets/images/nav/icn-summit.svg" alt="Kong Summit">Kong Summit</a>
                  </div>
                </div>
              <div class="kong-navbar-dropdown_column col-md-6">
                  <h5 class="list-group-item-action">Support</h5>
                  <div class="inner-wrap">
                  <a href="https://support.konghq.com" class="list-group-item-action"><img src="/assets/images/nav/icn-support.svg" alt="support">Enterprise Support Portal</a>
                  <a href="http://konghq.com/faqs/" class="list-group-item-action"><img src="/assets/images/nav/icn-faqs.svg" alt="faqs">FAQs</a>
                  </div>
                </div>
            </div> <!-- list-group-item -->
          </div> <!-- list-group -->
        </li>
        <li class="navbar-item kong-navbar-dropdown kong-navbar-dropdown-small"><a class="nav-link">Company</a>
          <div class="list-group company">
          <div class="list-group-item flex-row flex-wrap">
            <div class="list-item icon">
            <a href="http://konghq.com/about-kong-inc" class="list-group-item list-group-item-action"><img src="/assets/images/nav/icn-about.svg" alt="about"><span>About</span></a>
            </div>
            <div class="list-item icon">
            <a href="http://konghq.com/investors" class="list-group-item list-group-item-action"><img src="/assets/images/nav/icn-investors.svg" alt="investors"><span>Investors</span></a>
            </div>
            <div class="list-item icon">
            <a href="http://konghq.com/careers" class="list-group-item list-group-item-action"><img src="/assets/images/nav/icn-careers.svg" alt="careers"><span>Careers</span></a>
            </div>
            <div class="list-item icon">
            <a href="http://konghq.com/partners" class="list-group-item list-group-item-action"><img class="partners" src="/assets/images/nav/icn-partners.svg" alt="partners"><span>Partners</span></a>
            </div>
            <div class="list-item icon">
            <a href="http://konghq.com/press-room/" class="list-group-item list-group-item-action"><img src="/assets/images/nav/icn-press.svg" alt="press"><span>Press</span></a>
            </div>
            <div class="list-item icon">
            <a href="http://konghq.com/contact" class="list-group-item list-group-item-action"><img src="/assets/images/nav/icn-contact.svg" alt="contact"><span>Contact</span></a>
            </div>
          </div>
          </div>
        </li>
        <li class="kong-navbar_nav_link kong-navbar_nav_link--cta"><a class="nav-link btn btn-outline-secondary transparent" href="http://konghq.com/request-demo">Request Demo</a></li>
      </ul>
    </nav>
    <button class="navbar-toggler align-self-center" type="button" data-toggle="kong-expand" data-target="#pagesNav" aria-controls="pagesNav" aria-expanded="false" aria-label="Toggle navigation">
      <div></div>
      <div></div>
      <div></div>
    </button>
  </div>
  <nav id="oss_subnav" class="preheader expand">
    <ul id="oss_nav">
      <li class="label"><h4>Open Source</h4></li>
      <li class="slider_line""><a href="https://konghq.com/community/">Community</a></li>
      <li class="kubernetes slider_line"><a href="https://konghq.com/solutions/kubernetes-ingress/">Kubernetes</a></li>
      <li class="install slider_line"><a href="https://konghq.com/install/">Install Kong
        <svg width="12px" height="12px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 12 12" style="enable-background:new 0 0 12 12;" xml:space="preserve">
          <path fill="#004B80" class="st0" d="M12,10v2H0v-2H12z"></path>
          <g id="arrow">
            <polygon fill="#004B80" class="st1" points="7,5.6 8.3,4.3 9.7,5.7 6,9.4 2.3,5.7 3.7,4.3 5,5.6 5,0 7,0 	"></polygon>
          </g>
          </svg>
      </a></li>
    </ul>
    <span id="slide-line"></span>
  </nav>
</header>
<!---- Mobile Navigation ----->
<nav id="pagesNav" class="fixed-top hidden-xl-up kong-navbar-collapse">
<div class="btnwrap">
      <a class="btn" href="http://konghq.com/request-demo">Request Demo</a>
      <a href="http://konghq.com/install" class="btn btn-primary">Install</a>
    </div>
  <div class="kong-navbar-collapse_section row no-gutters justify-content-between section-left">
    <h5 class="col-12 trigger">
      <a class="nav-link">Products &nbsp;<i class="fas fa-chevron-right"></i></a>
    </h5>
    <div class="subnav">
    <h5 class="col-12"><a class="back nav-link"><i class="fas fa-chevron-left"></i>&nbsp; Products</a></h5>

      <div class="col-md-6">
          <h6>Offerings</h6>
          <div class="row">
            <div class="col-4">
              <a class="nav-link" href="http://konghq.com/kong/">Kong</a>
              <a class="nav-link" href="http://konghq.com/kong-enterprise/">Kong Enterprise</a>
              <a class="nav-link" href="http://konghq.com/cloud">Kong Cloud</a>
            </div>
          </div>
        </div>

        <div class="col-md-6">
          <h6>Service Control Platform</h6>
          <a class="nav-link" href="http://konghq.com/products/service-control-platform">Platform Overview</a>
          <a class="nav-link" href="http://konghq.com/products/kong-manager">Kong Manager</a>
          <a class="nav-link" href="http://konghq.com/api-dev-portal">Kong Dev Portal</a>
          <a class="nav-link" href="http://konghq.com/products/kong-vitals">Kong Vitals</a>
          <a class="nav-link" href="http://konghq.com/products/kong-brain">Kong Brain</a>
          <a class="nav-link" href="http://konghq.com/products/kong-immunity">Kong Immunity</a>
        </div>


    </div>
  </div>

  <div class="kong-navbar-collapse_section section-left">
    <h5 class="trigger">
      <a class="nav-link">Solutions &nbsp;<i class="fas fa-chevron-right"></i></a>
    </h5>
    <div class="subnav">
    <h5 class="col-12"><a class="back nav-link"><i class="fas fa-chevron-left"></i>&nbsp; Solutions</a></h5>
      <div class="col-md-6">
              <a class="nav-link" href="http://konghq.com/solutions/gateway/">API Gateway</a>
              <a class="nav-link" href="http://konghq.com/solutions/kubernetes-ingress/">Kubernetes Ingress</a>
              <a class="nav-link" href="http://konghq.com/solutions/service-mesh/">Service Mesh</a>
      </div>
    </div>
  </div>

  <div class="kong-navbar-collapse_section section-left">
    <h5 class="remove">
      <a class="nav-link" href="https://docs.konghq.com/hub">Plugins</a>
    </h5>
  </div>

  <div class="kong-navbar-collapse_section section-right">
    <h5 class="trigger">
      <a class="nav-link">Docs &nbsp;<i class="fas fa-chevron-right"></i></a>
    </h5>
    <div class="subnav">
      <h5 class="col-12"><a class="back nav-link"><i class="fas fa-chevron-left"></i>&nbsp; Docs</a></h5>
      <div class="col-md-6">
          <h6>Get Started</h6>
          <a class="nav-link" href="https://konghq.com/install/">Install</a>
          <a class="nav-link" href="https://docs.konghq.com/">Kong Docs + Getting Started</a>
      </div>
      <div class="col-md-6">
      <h6>Learn</h6>
      <a class="nav-link" href="https://docs.konghq.com/enterprise/">Deploy Kong Enterprise</a>
      <a class="nav-link" href="https://docs.konghq.com/enterprise/0.35-x/admin-api/vitals/">Master Kong Vitals</a>
      <a class="nav-link" href="https://docs.konghq.com/enterprise/latest/developer-portal/introduction/">Launch Your Dev Portal</a>
      </div>
    </div>
  </div>


  <div class="kong-navbar-collapse_section row no-gutters justify-content-between section-right">
    <h5 class="col-12 trigger">
      <a class="nav-link">Resources &nbsp;<i class="fas fa-chevron-right"></i></a>
    </h5>
    <div class="subnav">
      <h5 class="col-12"><a class="back nav-link"><i class="fas fa-chevron-left"></i>&nbsp; Resources</a></h5>
      <div class="col-md-6">
          <h6 class="shot-top">Downloads</h6>
          <a class="nav-link" href="http://konghq.com/blog">Blog</a>
          <a class="nav-link" href="http://konghq.com/ebooks">Ebooks</a>
          <a class="nav-link" href="http://konghq.com/webinars">Webinars</a>
          <a class="nav-link" href="http://konghq.com/briefs">Briefs</a>
        </div>
      <div class="col-md-6">
          <h6>Community</h6>
          <a class="nav-link" href="https://discuss.konghq.com/">Kong Nation</a>
          <a class="nav-link" href="https://github.com/Kong/">GitHub</a>
          <a class="nav-link" href="http://konghq.com/community/">Meetups</a>
          <a class="nav-link" href="http://konghq.com/kong-summit/">Kong Summit</a>
        </div>
        <div class="col-md-6">
          <h6>Support</h6>
          <a class="nav-link" href="https://support.konghq.com">Enterprise Support Portal</a>
          <a class="nav-link" href="http://konghq.com/faqs/">FAQs</a>
        </div>
  </div>

</div>

  <div class="kong-navbar-collapse_section section-right">
    <h5 class="trigger">
      <a class="nav-link">Company &nbsp;<i class="fas fa-chevron-right"></i></a>
    </h5>
      <div class="subnav">
        <h5 class="col-12"><a class="back nav-link"><i class="fas fa-chevron-left"></i>&nbsp; Company</a></h5>
        <div class="col-md-6">
          <a class="nav-link" href="http://konghq.com/about-kong-inc">About</a>
          <a class="nav-link" href="http://konghq.com/investors">Investors</a>
          <a class="nav-link" href="/careers">Careers</a>
          <a class="nav-link" href="http://konghq.com/partners">Partners</a>
          <a class="nav-link" href="http://konghq.com/press-room/">Press</a>
          <a class="nav-link" href="http://konghq.com/contact">Contact</a>
        </div>
      </div>
  </div>
  <div class="hidden-md-up kong-navbar-collapse_section kong-navbar-collapse_section--buttons">
  </div>
</nav>
</header>
<div class="overlay"></div>


    <div class="page ">
  <header class="page-header">
    <div class="container">
      <div class="edit-this-page">
        <a target="_blank" href="https://github.com/Kong/docs.konghq.com/tree/master/app/enterprise/0.34-x/loadbalancing.md"><i class="fa fa-github"></i>
          Edit this Page</a>
      </div>
      <nav class="docs-navigation">
        <a href="/" >Kong</a>
        <a href="/enterprise"  class="active" >Kong Enterprise</a>
        <span class="sidebar-toggle">Open Sidebar</span>
      </nav>
      <div class="page-header-icon">
        <img src="/assets/images/icons/icn-documentation-ee.svg"
          alt="Documentation" />
      </div>
      <div class="page-header-title">
        <h1>Load Balancing Reference</h1>
      </div>

      
      <div class="versions-dropdown dropdown page-header-right  page-header-right-enterprise ">
        <button class="page-header-btn" id="version-dropdown" type="button" data-toggle="dropdown" aria-haspopup="true"
          aria-expanded="false">
          Version 0.34-x
          
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="version-dropdown">
          
          <li >
            <a href="/enterprise/0.36-x" >
              0.36-x <em>(latest)</em>
            </a>
          </li>
          
          <li >
            <a href="/enterprise/0.35-x" >
              0.35-x 
            </a>
          </li>
          
          <li  class="active" >
            <a href="/enterprise/0.34-x"  class="active" >
              0.34-x 
            </a>
          </li>
          
          <li >
            <a href="/enterprise/0.33-x" >
              0.33-x 
            </a>
          </li>
          
          <li >
            <a href="/enterprise/0.32-x" >
              0.32-x 
            </a>
          </li>
          
          <li >
            <a href="/enterprise/0.31-x" >
              0.31-x 
            </a>
          </li>
          
        </ul>
        <div id="getkong-algolia-search" class="search-input">
          <i class="fa fa-search"></i>
          <input type="text" placeholder="Search" id="getkong-algolia-search-input" />
        </div>
      </div>
      
    </div>
  </header>

  <div class="container">
    <aside class="page-navigation">
      <span class="close-sidebar"></span>
      

      
      <nav>
        
        <h5>Getting Started</h5>
        
        <ul>
          
          
          <li>
            <a href="/enterprise/0.34-x/getting-started/introduction"  >
              Introduction
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/getting-started/quickstart"  >
              Five-minute quickstart
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/getting-started/configuring-a-service"  >
              Configuring a Service
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/getting-started/enabling-plugins"  >
              Enabling Plugins
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/getting-started/adding-consumers"  >
              Adding Consumers
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/getting-started/licensing"  >
              Licensing
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/getting-started/accessing-your-license"  >
              Accessing Your License
            </a>
            
          </li>
          
        </ul>
      </nav>
      
      <nav>
        
        <h5>Installation</h5>
        
        <ul>
          
          
          <li>
            <a href="/enterprise/0.34-x/installation/docker"  >
              Docker
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/installation/centos"  >
              CentOS
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/installation/amazon-linux"  >
              Amazon Linux
            </a>
            
          </li>
          
        </ul>
      </nav>
      
      <nav>
        
        <h5>APIs and Plugins</h5>
        
        <ul>
          
          
          <li>
            <a href="/enterprise/0.34-x/plugins/canary-release"  >
              Canary Release Plugin
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/plugins/rate-limiting-advanced"  >
              Rate Limiting Plugin
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/plugins/request-transformer"  >
              Request Transformer Plugin
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/plugins/oauth2-introspection"  >
              OAuth2 Introspection Plugin
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/plugins/openid-connect"  >
              OpenID Connect Plugin
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/plugins/http-proxy-caching"  >
              HTTP Proxy Caching
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/plugins/forward-proxy"  >
              Forward Proxy
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/plugins/statsd-advanced"  >
              StatsD Advanced Plugin
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/plugins/ldap-authentication-advanced"  >
              LDAP Auth Advanced Plugin
            </a>
            
          </li>
          
        </ul>
      </nav>
      
      <nav>
        
        <a href="/enterprise/0.34-x/admin-api/">
          <h5>Admin API</h5>
        </a>
        
        <ul>
          
          
          <li>
            <a href="/enterprise/0.34-x/admin-api/#supported-content-types"  >
              Supported Content Types
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/admin-api/#information-routes"  >
              Information
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/admin-api/#service-object"  >
              Service Object
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/admin-api/#route-object"  >
              Route Object
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/admin-api/#api-object"  >
              API Object
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/admin-api/#consumer-object"  >
              Consumer Object
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/admin-api/#plugin-object"  >
              Plugin Object
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/admin-api/#certificate-object"  >
              Certificate Object
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/admin-api/#sni-objects"  >
              SNI Object
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/admin-api/#upstream-objects"  >
              Upstream Object
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/admin-api/#target-object"  >
              Target Object
            </a>
            
          </li>
          
        </ul>
      </nav>
      
      <nav>
        
        <h5>Workspaces</h5>
        
        <ul>
          
          
          <li>
            <a href="/enterprise/0.34-x/workspaces/overview"  >
              Overview
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/workspaces/admin-api"  >
              Admin API
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/workspaces/examples"  >
              Examples
            </a>
            
          </li>
          
        </ul>
      </nav>
      
      <nav>
        
        <h5>RBAC</h5>
        
        <ul>
          
          
          <li>
            <a href="/enterprise/0.34-x/rbac/overview"  >
              Overview
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/rbac/admin-api"  >
              Admin API
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/rbac/examples"  >
              Examples
            </a>
            
          </li>
          
        </ul>
      </nav>
      
      <nav>
        
        <h5>Vitals</h5>
        
        <ul>
          
          
          <li>
            <a href="/enterprise/0.34-x/vitals"  >
              Kong Vitals
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/vitals-influx-strategy"  >
              Kong Vitals with InfluxDB
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/vitals-prometheus-strategy"  >
              Kong Vitals with Prometheus
            </a>
            
          </li>
          
        </ul>
      </nav>
      
      <nav>
        
        <h5>Kong Manager</h5>
        
        <ul>
          
          
          <li>
            <a href="/enterprise/0.34-x/kong-manager/overview"  >
              Overview
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/kong-manager/configuration/getting-started"  >
              Configuration
            </a>
            
            <ul>
              
              
              <li>
                <a href="/enterprise/0.34-x/kong-manager/configuration/getting-started" >Getting Started</a>
                
              </li>
              
              
              <li>
                <a href="/enterprise/0.34-x/kong-manager/configuration/authentication" >Authentication</a>
                
              </li>
              
              
              <li>
                <a href="/enterprise/0.34-x/kong-manager/configuration/networking" >Networking</a>
                
              </li>
              
            </ul>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/kong-manager/organization-management/workspaces"  >
              Organization Management
            </a>
            
            <ul>
              
              
              <li>
                <a href="/enterprise/0.34-x/kong-manager/organization-management/workspaces" >Workspaces</a>
                
              </li>
              
              
              <li>
                <a href="/enterprise/0.34-x/kong-manager/organization-management/rbac-and-perms" >RBAC and Permissions</a>
                
              </li>
              
              
              <li>
                <a href="/enterprise/0.34-x/kong-manager/organization-management/managing-admins" >Managing Admins</a>
                
              </li>
              
            </ul>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/kong-manager/vitals"  >
              Vitals
            </a>
            
          </li>
          
        </ul>
      </nav>
      
      <nav>
        
        <h5>Kong Dev Portal</h5>
        
        <ul>
          
          
          <li>
            <a href="/enterprise/0.34-x/developer-portal/introduction"  >
              Overview
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/developer-portal/configuration/getting-started"  >
              Configuration
            </a>
            
            <ul>
              
              
              <li>
                <a href="/enterprise/0.34-x/developer-portal/configuration/getting-started" >Getting Started</a>
                
              </li>
              
              
              <li>
                <a href="/enterprise/0.34-x/developer-portal/configuration/authentication" >Authentication</a>
                
              </li>
              
              
              <li>
                <a href="/enterprise/0.34-x/developer-portal/configuration/networking" >Networking</a>
                
              </li>
              
              
              <li>
                <a href="/enterprise/0.34-x/developer-portal/configuration/smtp" >SMTP</a>
                
              </li>
              
              
              <li>
                <a href="/enterprise/0.34-x/developer-portal/configuration/workspaces" >Working with Workspaces</a>
                
              </li>
              
            </ul>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/developer-portal/management/file-management"  >
              Management
            </a>
            
            <ul>
              
              
              <li>
                <a href="/enterprise/0.34-x/developer-portal/management/file-management" >File Management</a>
                
              </li>
              
              
              <li>
                <a href="/enterprise/0.34-x/developer-portal/management/developers" >Managing Developers</a>
                
              </li>
              
            </ul>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/developer-portal/customization/customization"  >
              Customization
            </a>
            
            <ul>
              
              
              <li>
                <a href="/enterprise/0.34-x/developer-portal/customization/customization" >Customizing the Dev Portal</a>
                
              </li>
              
              
              <li>
                <a href="/enterprise/0.34-x/developer-portal/customization/smart-components" >Smart Components</a>
                
              </li>
              
            </ul>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/developer-portal/developers/developer-access"  >
              Developers
            </a>
            
            <ul>
              
              
              <li>
                <a href="/enterprise/0.34-x/developer-portal/developers/developer-access" >Account Management</a>
                
              </li>
              
            </ul>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/developer-portal/faq"  >
              FAQ & Troubleshooting
            </a>
            
          </li>
          
        </ul>
      </nav>
      
      <nav>
        
        <h5>Guides &amp; References</h5>
        
        <ul>
          
          
          <li>
            <a href="/enterprise/0.34-x/property-reference"  >
              Configuration Property Reference
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/deployment-guide"  >
              Kong Deployment Guide
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/changelog"  >
              Changelog
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/kong-architecture-overview"  >
              Architecture Overview
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/kong-architecture-patterns"  >
              Architecture Patterns
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/rate-limiting"  >
              Rate Limiting Library
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/admin-api-audit-log"  >
              Admin API Audit Logging
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/edition-versioning"  >
              Kong Enterprise Versioning
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/allowing-multiple-authentication-methods"  >
              Multiple Authentication Methods
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/postgresql-redhat"  >
              PostgreSQL on RedHat
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/oidc-google"  >
              OpenID Connect with Google
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/oidc-auth0"  >
              OpenID Connect with Auth0
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/upgrades-migrations"  >
              Upgrades and Migrations
            </a>
            
          </li>
          
          
          <li>
            <a href="/enterprise/0.34-x/kong-aws"  >
              AWS Guide and Best Practices
            </a>
            
          </li>
          
        </ul>
      </nav>
      
    </aside>

    <div class="page-content-container" id="documentation">
      <div class="page-content">
        <div class="content show-anchor-links">
          
          
          <div class="alert alert-warning">
            <strong>Careful!</strong> You are browsing documentation for an outdated version of Kong. Go <a href="/latest">here</a>
            to browse the documentation for the latest version.
          </div>
          

          
          
          <h2 id="table-of-contents">Table of Contents</h2>
          <ul>
  <li><a href="#introduction" class="scroll-to">Introduction</a></li>
  <li><a href="#dns-based-load-balancing" class="scroll-to">DNS-based load balancing</a>
    <ul>
      <li><a href="#a-records" class="scroll-to">A records</a></li>
      <li><a href="#srv-records" class="scroll-to">SRV records</a></li>
      <li><a href="#dns-priorities" class="scroll-to">DNS priorities</a></li>
      <li><a href="#dns-caveats" class="scroll-to">DNS caveats</a></li>
    </ul>
  </li>
  <li><a href="#ring-balancer" class="scroll-to">Ring-balancer</a>
    <ul>
      <li><a href="#upstream" class="scroll-to">Upstream</a></li>
      <li><a href="#target" class="scroll-to">Target</a></li>
      <li><a href="#balancing-algorithms" class="scroll-to">Balancing algorithms</a></li>
      <li><a href="#balancing-caveats" class="scroll-to">Balancing caveats</a></li>
    </ul>
  </li>
  <li><a href="#blue-green-deployments" class="scroll-to">Blue-Green Deployments</a></li>
  <li><a href="#canary-releases" class="scroll-to">Canary Releases</a></li>
</ul>

          

          <h2 id="introduction">Introduction</h2>

<p>Kong provides multiple ways of load balancing requests to multiple backend
services: a straightforward DNS-based method, and a more dynamic ring-balancer
that also allows for service registry without needing a DNS server.</p>

<h2 id="dns-based-load-balancing">DNS-based load balancing</h2>

<p>When using DNS-based load balancing, the registration of the backend services
is done outside of Kong, and Kong only receives updates from the DNS server.</p>

<p>Every Service that has been defined with a <code class="highlighter-rouge">host</code> containing a hostname
(instead of an IP address) will automatically use DNS-based load balancing
if the name resolves to multiple IP addresses, provided the hostname does not
resolve to an <code class="highlighter-rouge">upstream</code> name or a name in your DNS hostsfile.</p>

<p>The DNS record <code class="highlighter-rouge">ttl</code> setting (time to live) determines how often the information
is refreshed. When using a <code class="highlighter-rouge">ttl</code> of 0, every request will be resolved using its
own DNS query. Obviously this will have a performance penalty, but the latency of
updates/changes will be very low.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="a-records">A records</h3>

<p>An A record contains one or more IP addresses. Hence, when a hostname
resolves to an A record, each backend service must have its own IP address.</p>

<p>Because there is no <code class="highlighter-rouge">weight</code> information, all entries will be treated as equally
weighted in the load balancer, and the balancer will do a straight forward
round-robin.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="srv-records">SRV records</h3>

<p>An SRV record contains weight and port information for all of its IP addresses.
A backend service can be identified by a unique combination of IP address
and port number. Hence, a single IP address can host multiple instances of the
same service on different ports.</p>

<p>Because the <code class="highlighter-rouge">weight</code> information is available, each entry will get its own
weight in the load balancer and it will perform a weighted round-robin.</p>

<p>Similarly, any given port information will be overridden by the port information from
the DNS server. If a Service has attributes <code class="highlighter-rouge">host=myhost.com</code> and <code class="highlighter-rouge">port=123</code>,
and <code class="highlighter-rouge">myhost.com</code> resolves to an SRV record with <code class="highlighter-rouge">127.0.0.1:456</code>, then the request
will be proxied to <code class="highlighter-rouge">http://127.0.0.1:456/somepath</code>, as port <code class="highlighter-rouge">123</code> will be
overridden by <code class="highlighter-rouge">456</code>.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="dns-priorities">DNS priorities</h3>

<p>The DNS resolver will start resolving the following record types in order:</p>

<ol>
  <li>The last successful type previously resolved</li>
  <li>SRV record</li>
  <li>A record</li>
  <li>CNAME record</li>
</ol>

<p>This order is configurable through the <a href="/enterprise/0.34-x/property-reference/#dns_order"><code class="highlighter-rouge">dns_order</code> configuration property</a>.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="dns-caveats">DNS caveats</h3>

<ul>
  <li>
    <p>Whenever the DNS record is refreshed a list is generated to handle the
weighting properly. Try to keep the weights as multiples of each other to keep
the algorithm performant, e.g., 2 weights of 17 and 31 would result in a structure
with 527 entries, whereas weights 16 and 32 (or their smallest relative
counterparts 1 and 2) would result in a structure with merely 3 entries,
especially with a very small (or even 0) <code class="highlighter-rouge">ttl</code> value.</p>
  </li>
  <li>
    <p>Some nameservers do not return all entries (due to UDP packet size) in those
cases (for example Consul returns a maximum of 3) a given Kong node will only
use the few upstream service instances provided by the nameserver. In this
scenario, it is possible that the pool of upstream instances will be loaded
inconsistently, because the Kong node is effectively unaware of some of the
instances, due to the limited information provided by the nameserver.
To mitigate this use a different nameserver, use IP
addresses instead of names, or make sure you use enough Kong nodes to still
have all upstream services being used.</p>
  </li>
  <li>
    <p>When the nameserver returns a <code class="highlighter-rouge">3 name error</code>, then that is a valid response
for Kong. If this is unexpected, first validate the correct name is being
queried for, and second check your nameserver configuration.</p>
  </li>
  <li>
    <p>The initial pick of an IP address from a DNS record (A or SRV) is not
randomized. So when using records with a <code class="highlighter-rouge">ttl</code> of 0, the nameserver is
expected to randomize the record entries.</p>
  </li>
</ul>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h2 id="ring-balancer">Ring-balancer</h2>

<p>When using the ring-balancer, the adding and removing of backend services will
be handled by Kong, and no DNS updates will be necessary. Kong will act as the
service registry. Nodes can be added/deleted with a single HTTP request and
will instantly start/stop receiving traffic.</p>

<p>Configuring the ring-balancer is done through the <code class="highlighter-rouge">upstream</code> and <code class="highlighter-rouge">target</code>
entities.</p>

<ul>
  <li><code class="highlighter-rouge">target</code>: an IP address or hostname with a port number where a backend
service resides, eg. “192.168.100.12:80”. Each target gets an additional
<code class="highlighter-rouge">weight</code> to indicate the relative load it gets. IP addresses can be
in both IPv4 and IPv6 format.</li>
  <li><code class="highlighter-rouge">upstream</code>: a ‘virtual hostname’ which can be used in a Route <code class="highlighter-rouge">host</code>
field, e.g., an upstream named <code class="highlighter-rouge">weather.v2.service</code> would get all requests
from a Service with <code class="highlighter-rouge">host=weather.v2.service</code>.</li>
</ul>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="upstream">Upstream</h3>

<p>Each upstream gets its own ring-balancer. Each <code class="highlighter-rouge">upstream</code> can have many
<code class="highlighter-rouge">target</code> entries attached to it, and requests proxied to the ‘virtual hostname’
will be load balanced over the targets. A ring-balancer has a pre-defined
number of slots, and based on the target weights the slots get assigned to the
targets of the upstream.</p>

<p>Adding and removing targets can be done with a simple HTTP request on the
Admin API. This operation is relatively cheap. Changing the upstream
itself is more expensive as the balancer will need to be rebuilt when the
number of slots change for example.</p>

<p>The only occurrence where the balancer will be rebuilt automatically is when
the target history is cleaned; other than that, it will only rebuild upon changes.</p>

<p>Within the balancer there are the positions (from 1 to <code class="highlighter-rouge">slots</code>),
which are <strong>randomly distributed</strong> on the ring.
The randomness is required to make invoking the ring-balancer cheap at
runtime. A simple round-robin over the wheel (the positions) will do to
provide a well distributed weighted round-robin over the <code class="highlighter-rouge">targets</code>, whilst
also having cheap operations when inserting/deleting targets.</p>

<p>The number of slots to use per target should (at least) be around 100 to make
sure the slots are properly distributed. Eg. for an expected maximum of 8
targets, the <code class="highlighter-rouge">upstream</code> should be defined with at least <code class="highlighter-rouge">slots=800</code>, even if
the initial setup only features 2 targets.</p>

<p>The tradeoff here is that the higher the number of slots, the better the random
distribution, but the more expensive the changes are (add/removing targets)</p>

<p>Detailed information on adding and manipulating
upstreams is available in the <code class="highlighter-rouge">upstream</code> section of the
<a href="/enterprise/0.34-x/admin-api#upstream-object">Admin API reference</a>.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="target">Target</h3>

<p>Because the <code class="highlighter-rouge">upstream</code> maintains a history of changes, targets can only be
added, not modified nor deleted. To change a target, just add a new entry for
the target, and change the <code class="highlighter-rouge">weight</code> value. The last entry is the one that will
be used. As such setting <code class="highlighter-rouge">weight=0</code> will disable a target, effectively
deleting it from the balancer. Detailed information on adding and manipulating
targets is available in the <code class="highlighter-rouge">target</code> section of the
<a href="/enterprise/0.34-x/admin-api#target-object">Admin API reference</a>.</p>

<p>The targets will be automatically cleaned when there are 10x more inactive
entries than active ones. Cleaning will involve rebuilding the balancer, and
hence is more expensive than just adding a target entry.</p>

<p>A <code class="highlighter-rouge">target</code> can also have a hostname instead of an IP address. In that case
the name will be resolved and all entries found will individually be added to
the ring balancer, e.g., adding <code class="highlighter-rouge">api.host.com:123</code> with <code class="highlighter-rouge">weight=100</code>. The
name ‘api.host.com’ resolves to an A record with 2 IP addresses. Then both
ip addresses will be added as target, each getting <code class="highlighter-rouge">weight=100</code> and port 123.
<strong>NOTE</strong>: the weight is used for the individual entries, not for the whole!</p>

<p>Would it resolve to an SRV record, then also the <code class="highlighter-rouge">port</code> and <code class="highlighter-rouge">weight</code> fields
from the DNS record would be picked up, and would overrule the given port <code class="highlighter-rouge">123</code>
and <code class="highlighter-rouge">weight=100</code>.</p>

<p>The balancer will honor the DNS record’s <code class="highlighter-rouge">ttl</code> setting and requery and update
the balancer when it expires.</p>

<p><strong>Exception</strong>: When a DNS record has <code class="highlighter-rouge">ttl=0</code>, the hostname will be added
as a single target, with the specified weight. Upon every proxied request
to this target it will query the nameserver again.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="balancing-algorithms">Balancing algorithms</h3>

<p>By default a ring-balancer will use a weighted-round-robin scheme. The alternative
would be to use the hash-based algorithm. The input for the hash can be either
<code class="highlighter-rouge">none</code>, <code class="highlighter-rouge">consumer</code>, <code class="highlighter-rouge">ip</code>, or <code class="highlighter-rouge">header</code>. When set to <code class="highlighter-rouge">none</code> the
weighted-round-robin scheme will be used, and hashing will be disabled.</p>

<p>There are two options, a primary and a fallback in case the primary fails
(e.g., if the primary is set to <code class="highlighter-rouge">consumer</code>, but no consumer is authenticated)</p>

<p>The different hashing options:</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">none</code>: Do not use hashing, but use weighted-round-robin instead (default).</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">consumer</code>: Use the consumer id as the hash input. This option will fallback
on the credential id if no consumer id is available (in case of external auth
like ldap).</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">ip</code>: The remote (originating) IP address will be used as input. Review the
configuration settings for <a href="/enterprise/0.34-x/property-reference/#real_ip_header">determining the real IP</a> when
using this.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">header</code>: use a specified header (in either <code class="highlighter-rouge">hash_on_header</code> or <code class="highlighter-rouge">hash_fallback_header</code>
field) as input for the hash.</p>
  </li>
</ul>

<p>The hashing algorithm is based on ‘consistent-hashing’ (or the ‘ketama principle’)
which makes sure that when the balancer gets modified by changing the targets
(adding, removing, failing, or changing weights) only the minimum number of
hashing losses occur. This will maximize upstream cache hits.</p>

<p>For more information on the exact settings see the <code class="highlighter-rouge">upstream</code> section of the
<a href="/enterprise/0.34-x/admin-api#upstream-object">Admin API reference</a>.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="balancing-caveats">Balancing caveats</h3>

<p>The ring-balancer is designed to work both with a single node as well as in a cluster.
For the weighted-round-robin algorithm there isn’t much difference, but when using
the hash based algorithm it is important that all nodes build the exact same
ring-balancer to make sure they all work identical. To do this the balancer
must be build in a deterministic way.</p>

<ul>
  <li>
    <p>Do not use hostnames in the balancer as the
balancers might/will slowly diverge because the DNS ttl has only second precision
and renewal is determined by when a name is actually requested. On top of this is
the issue with some nameservers not returning all entries, which exacerbates
this problem. So when using the hashing approach in a Kong cluster, add <code class="highlighter-rouge">target</code>
entities only by their IP address, and never by name.</p>
  </li>
  <li>
    <p>When picking your hash input make sure the input has enough variance to get
to a well distributed hash. Hashes will be calculated using the CRC-32 digest.
So for example, if your system has thousands of users, but only a few consumers, defined
per platform (eg. 3 consumers: Web, iOS and Android) then picking the <code class="highlighter-rouge">consumer</code>
hash input will not suffice, using the remote IP address by setting the hash to
<code class="highlighter-rouge">ip</code> would provide more variance in the input and hence a better distribution
in the hash output.</p>
  </li>
</ul>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h2 id="blue-green-deployments">Blue-Green Deployments</h2>

<p>Using the ring-balancer a <a href="http://blog.christianposta.com/deploy/blue-green-deployments-a-b-testing-and-canary-releases/">blue-green deployment</a> can be easily orchestrated for
a Service. Switching target infrastructure only requires a <code class="highlighter-rouge">PATCH</code> request on a
Service, to change its <code class="highlighter-rouge">host</code> value.</p>

<p>Set up the “Blue” environment, running version 1 of the address service:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># create an upstream</span>
<span class="nv">$ </span>curl <span class="nt">-X</span> POST http://kong:8001/upstreams <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"name=address.v1.service"</span>

<span class="c"># add two targets to the upstream</span>
<span class="nv">$ </span>curl <span class="nt">-X</span> POST http://kong:8001/upstreams/address.v1.service/targets <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"target=192.168.34.15:80"</span>
    <span class="nt">--data</span> <span class="s2">"weight=100"</span>
<span class="nv">$ </span>curl <span class="nt">-X</span> POST http://kong:8001/upstreams/address.v1.service/targets <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"target=192.168.34.16:80"</span>
    <span class="nt">--data</span> <span class="s2">"weight=50"</span>

<span class="c"># create a Service targeting the Blue upstream</span>
<span class="nv">$ </span>curl <span class="nt">-X</span> POST http://kong:8001/services/ <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"name=address-service"</span> <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"host=address.v1.service"</span> <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"path=/address"</span>

<span class="c"># finally, add a Route as an entry-point into the Service</span>
<span class="nv">$ </span>curl <span class="nt">-X</span> POST http://kong:8001/services/address-service/routes/ <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"hosts[]=address.mydomain.com"</span>
</code></pre></div></div>

<p>Requests with host header set to <code class="highlighter-rouge">address.mydomain.com</code> will now be proxied
by Kong to the two defined targets; 2/3 of the requests will go to
<code class="highlighter-rouge">http://192.168.34.15:80/address</code> (<code class="highlighter-rouge">weight=100</code>), and 1/3 will go to
<code class="highlighter-rouge">http://192.168.34.16:80/address</code> (<code class="highlighter-rouge">weight=50</code>).</p>

<p>Before deploying version 2 of the address service, set up the “Green”
environment:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># create a new Green upstream for address service v2</span>
<span class="nv">$ </span>curl <span class="nt">-X</span> POST http://kong:8001/upstreams <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"name=address.v2.service"</span>

<span class="c"># add targets to the upstream</span>
<span class="nv">$ </span>curl <span class="nt">-X</span> POST http://kong:8001/upstreams/address.v2.service/targets <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"target=192.168.34.17:80"</span>
    <span class="nt">--data</span> <span class="s2">"weight=100"</span>
<span class="nv">$ </span>curl <span class="nt">-X</span> POST http://kong:8001/upstreams/address.v2.service/targets <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"target=192.168.34.18:80"</span>
    <span class="nt">--data</span> <span class="s2">"weight=100"</span>
</code></pre></div></div>

<p>To activate the Blue/Green switch, we now only need to update the Service:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Switch the Service from Blue to Green upstream, v1 -&gt; v2</span>
<span class="nv">$ </span>curl <span class="nt">-X</span> PATCH http://kong:8001/services/address-service <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"host=address.v2.service"</span>
</code></pre></div></div>

<p>Incoming requests with host header set to <code class="highlighter-rouge">address.mydomain.com</code> will now be
proxied by Kong to the new targets; 1/2 of the requests will go to
<code class="highlighter-rouge">http://192.168.34.17:80/address</code> (<code class="highlighter-rouge">weight=100</code>), and the other 1/2 will go to
<code class="highlighter-rouge">http://192.168.34.18:80/address</code> (<code class="highlighter-rouge">weight=100</code>).</p>

<p>As always, the changes through the Kong Admin API are dynamic and will take
effect immediately. No reload or restart is required, and no in progress
requests will be dropped.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h2 id="canary-releases">Canary Releases</h2>

<p>Using the ring-balancer, target weights can be adjusted granularly, allowing
for a smooth, controlled <a href="http://blog.christianposta.com/deploy/blue-green-deployments-a-b-testing-and-canary-releases/">canary release</a>.</p>

<p>Using a very simple 2 target example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># first target at 1000</span>
<span class="nv">$ </span>curl <span class="nt">-X</span> POST http://kong:8001/upstreams/address.v2.service/targets <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"target=192.168.34.17:80"</span>
    <span class="nt">--data</span> <span class="s2">"weight=1000"</span>

<span class="c"># second target at 0</span>
<span class="nv">$ </span>curl <span class="nt">-X</span> POST http://kong:8001/upstreams/address.v2.service/targets <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"target=192.168.34.18:80"</span>
    <span class="nt">--data</span> <span class="s2">"weight=0"</span>
</code></pre></div></div>

<p>By repeating the requests, but altering the weights each time, traffic will
slowly be routed towards the other target. For example, set it at 10%:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># first target at 900</span>
<span class="nv">$ </span>curl <span class="nt">-X</span> POST http://kong:8001/upstreams/address.v2.service/targets <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"target=192.168.34.17:80"</span>
    <span class="nt">--data</span> <span class="s2">"weight=900"</span>

<span class="c"># second target at 100</span>
<span class="nv">$ </span>curl <span class="nt">-X</span> POST http://kong:8001/upstreams/address.v2.service/targets <span class="se">\</span>
    <span class="nt">--data</span> <span class="s2">"target=192.168.34.18:80"</span>
    <span class="nt">--data</span> <span class="s2">"weight=100"</span>
</code></pre></div></div>

<p>The changes through the Kong Admin API are dynamic and will take
effect immediately. No reload or restart is required, and no in progress
requests will be dropped.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>



        </div>
      </div>
    </div>
  </div>
</div>
<style>
  @media (max-width: 768px) {
    .algolia-docsearch-suggestion--subcategory-column{
      display: none !important;
    }
  }
</style>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>




<script type="text/javascript">
  docsearch({
    appId: 'T5JKD83LWT',
    apiKey: '1390283021f26e36117242934deb8d9d',
    indexName: 'prod_EE',
    inputSelector: '#getkong-algolia-search-input',
    algoliaOptions: {
      hitsPerPage: 5,
      'facetFilters': ["version: 0.34-x"]
    },
    // Override selected event to allow for local environment navigation
    handleSelected: function (input, event, suggestion) {
      input.setVal('');
      window.location.href = window.location.protocol + "//" + window.location.host + suggestion.url.split(
        "docs.konghq.com")[1]
    }
    // ,debug: true // Set debug to true if you want to inspect the dropdown
  });

</script>



    
<footer class="marketing-footer--light-gray">
  <section>
    <ul class="newsletter">
      <li class="logo-wrapper">
        <div class="logo">
          <img src="/assets/images/Kogo-gradient.svg" alt="Kong" />
        </div>
        <div class="form">
            <iframe src="https://go.konghq.com/l/392112/2019-02-14/bhxq9c" width="100%" height="60" type="text/html" frameborder="0" allowTransparency="true" style="border: 0"></iframe>
        </div>
        <div class="social">

          <div class="social-link">
            <a href="https://www.facebook.com/konghq/" title="Facebook"
              ><i
                aria-label="Facebook"
                class="fa fa-facebook-official"
                aria-hidden="true"
              ></i
            ></a>
          </div>
          <div class="social-link">
            <a href="https://twitter.com/thekonginc" title="Twitter"
              ><i
                aria-label="Twitter"
                class="fa fa-twitter"
                aria-hidden="true"
              ></i
            ></a>
          </div>
          <div class="social-link">
            <a href="https://www.meetup.com/topics/kong/all/" title="Meetup"
              ><i
              aria-label="Meetup"
              class="fa fa-meetup"
              aria-hidden="true"
            ></i
          ></a>
          </div>
          <div class="social-link">
            <a href="https://linkedin.com/company/278819" title="LinkedIn"
              ><i aria-label="GitHub" class="fa fa-linkedin" aria-hidden="true"></i
            ></a>
          </div>
          <div class="social-link">
            <a href="https://github.com/kong/kong" target="blank" class="btn-gh">
              <i class="fa fa-github" aria-hidden="true" aria-label="GitHub"></i> Star
            </a>
          </div>
        </div>
      </li>
      <li>
        <nav>
          <h5>Products</h5>
          <ul>
            <li><a href="http://konghq.com/kong/">Kong</a></li>
            <li><a href="http://konghq.com/kong-enterprise/">Kong Enterprise</a></li>
            <li><a href="http://konghq.com/cloud/">Kong Cloud</a></li>
            <li><a href="http://konghq.com/subscriptions/">Subscriptions</a></li>
          </ul>
        </nav>
      </li>
      <li>
        <nav>
          <h5>Resources</h5>
          <ul>
            <li>
              <a href="https://support.konghq.com" target="blank"
                >Enterprise Support</a
              >
            </li>
            <li>
              <a href="https://docs.konghq.com">Documentation</a>
            </li>
            <li><a href="http://konghq.com/partners/">Partners</a></li>
            <li><a href="http://konghq.com/webinars/">Webinars</a></li>
            <li><a href="http://konghq.com/ebooks/">Ebooks</a></li>
          </ul>
        </nav>
      </li>
      <li>
        <nav>
          <h5>Company</h5>
          <ul>
            <li><a href="http://konghq.com/about-kong-inc/">About</a></li>
            <li><a href="http://konghq.com/investors/">Investors</a></li>
            <li><a href="http://konghq.com/blog/">News</a></li>
            <li>
              <a href="http://konghq.com/careers/">Careers <span>Hiring!</span></a>
            </li>
            <li><a href="http://konghq.com/kong-summit/">Kong Summit</a></li>
            <li><a href="http://konghq.com/contact/">Contact</a></li>
          </ul>
        </nav>
      </li>
      <li>
        <nav>
          <h5>Open Source</h5>
          <ul>
            <li><a href="http://konghq.com/install/">Install</a></li>
            <li><a target="blank" href="https://github.com/Kong/">GitHub</a></li>
            <li><a href="https://discuss.konghq.com/"">Kong Nation</a></li>
            <li><a href="http://konghq.com/community/">Community</a></li>
          </ul>
        </nav>
      </li>
    </ul>
  </section>

  <section class="legal">
    <ul>
      <li>
        <span class="mashape-footer-content">&copy; Kong Inc. 2019 &nbsp; <a href="http://konghq.com/terms/">Terms</a><b>•</b><a href="http://konghq.com/privacy/">Privacy</a></span>
      </li>
    </ul>
  </section>

  <script type="text/javascript">
    function onSubmit(response) {
      document.getElementById('subscription_form').submit();
      document.getElementById('follow_up_subscription_form').submit();
      if (response.length == 0) {
        alert('reCaptcha verification failed');
      }
    }
  </script>
</footer>
 <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<span class=\"sr-only\">Permalink</span><i class=\"fa fa-link\"></i>";
    anchor.title = "Permalink";
    return anchor;
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var className =
        ".show-anchor-links h1, .show-anchor-links h2, .show-anchor-links h3, " +
        ".show-anchor-links h4, .show-anchor-links h5, .show-anchor-links h6";
      var headers = document.querySelectorAll(className);

      for (var i = 0; i < headers.length; i++) {
        var header = headers[i];
        if (typeof header.id !== "undefined" && header.id !== "") {
          header.prepend(anchorForId(header.id));
        }
      }
    }
  };
</script>


    <script src="/assets/app.js?v=1566241358"></script>

    <div id="fb-root"></div>

    <script
      src="https://2tjosk2rxzc21medji3nfn1g-wpengine.netdna-ssl.com/wp-content/themes/konghq/assets/js/vendor/bootstrap.min.js"
      async
      defer
    ></script>

    <script
      id="github-bjs"
      src="https://buttons.github.io/buttons.js"
      async
      defer
    ></script>
    <script
      id="twitter-wjs"
      type="text/javascript"
      src="https://platform.twitter.com/widgets.js"
      async
      defer
    ></script>
    <script
      id="facebook-jssdk"
      type="text/javascript"
      src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3&appId=842731852424506"
      async
      defer
    ></script>

    <script type="text/javascript">
      piAId = '393112';
      piCId = '48375';

      (function() {
        function async_load() {
          var s = document.createElement('script');
          s.type = 'text/javascript';
          s.src =
            ('https:' == document.location.protocol
              ? 'https://pi'
              : 'http://cdn') + '.pardot.com/pd.js';
          var c = document.getElementsByTagName('script')[0];
          c.parentNode.insertBefore(s, c);
        }
        if (window.attachEvent) {
          window.attachEvent('onload', async_load);
        } else {
          window.addEventListener('load', async_load, false);
        }
      })();
    </script>

    <script type="text/javascript">
      var _vwo_code = (function() {
        var account_id = 125292,
          settings_tolerance = 2000,
          library_tolerance = 2500,
          use_existing_jquery = true,
          // DO NOT EDIT BELOW THIS LINE
          f = false,
          d = document;
        return {
          use_existing_jquery: function() {
            return use_existing_jquery;
          },
          library_tolerance: function() {
            return library_tolerance;
          },
          finish: function() {
            if (!f) {
              f = true;
              var a = d.getElementById('_vis_opt_path_hides');
              if (a) a.parentNode.removeChild(a);
            }
          },
          finished: function() {
            return f;
          },
          load: function(a) {
            var b = d.createElement('script');
            b.src = a;
            b.type = 'text/javascript';
            b.innerText;
            b.onerror = function() {
              _vwo_code.finish();
            };
            d.getElementsByTagName('head')[0].appendChild(b);
          },
          init: function() {
            settings_timer = setTimeout(
              '_vwo_code.finish()',
              settings_tolerance
            );
            this.load(
              '//dev.visualwebsiteoptimizer.com/j.php?a=' +
                account_id +
                '&u=' +
                encodeURIComponent(d.URL) +
                '&r=' +
                Math.random()
            );
            var a = d.createElement('style'),
              b = '',
              h = d.getElementsByTagName('head')[0];
            a.setAttribute('id', '_vis_opt_path_hides');
            a.setAttribute('type', 'text/css');
            if (a.styleSheet) a.styleSheet.cssText = b;
            else a.appendChild(d.createTextNode(b));
            h.appendChild(a);
            return settings_timer;
          }
        };
      })();
      _vwo_settings_timer = _vwo_code.init();
    </script>

    <script type="text/javascript">
      !(function() {
        var analytics = (window.analytics = window.analytics || []);
        if (!analytics.initialize)
          if (analytics.invoked)
            window.console &&
              console.error &&
              console.error('Segment snippet included twice.');
          else {
            analytics.invoked = !0;
            analytics.methods = [
              'trackSubmit',
              'trackClick',
              'trackLink',
              'trackForm',
              'pageview',
              'identify',
              'group',
              'track',
              'ready',
              'alias',
              'page',
              'once',
              'off',
              'on'
            ];
            analytics.factory = function(t) {
              return function() {
                var e = Array.prototype.slice.call(arguments);
                e.unshift(t);
                analytics.push(e);
                return analytics;
              };
            };
            for (var t = 0; t < analytics.methods.length; t++) {
              var e = analytics.methods[t];
              analytics[e] = analytics.factory(e);
            }
            analytics.load = function(t) {
              var e = document.createElement('script');
              e.type = 'text/javascript';
              e.async = !0;
              e.src =
                ('https:' === document.location.protocol
                  ? 'https://'
                  : 'http://') +
                'cdn.segment.com/analytics.js/v1/' +
                t +
                '/analytics.min.js';
              var n = document.getElementsByTagName('script')[0];
              n.parentNode.insertBefore(e, n);
            };
            analytics.SNIPPET_VERSION = '3.0.1';
            analytics.load('WDj0nSS7hpyxwL3evgbOzK755s0NUye6');
            analytics.page();
          }
      })();
    </script>

    <script>
      // Collapse Toggler
      $('button[data-toggle="kong-expand"]').on('click', function(e) {
        e.stopPropagation();
        var $this = $(this);
        $($this.data('target')).toggleClass('kong-navbar-collapse--expand');
        $this.toggleClass('active').attr('aria-expanded', true);
        $('.kong-navbar-collapse_section').removeClass('shift');
        $('.subnav, .trigger, .remove').removeClass('active');
      });

      function closeMenu(e) {
        var target = e.target; // Get target
        var menu = $('nav#pagesNav'); // Get menu container
        var header = $('header.navbar'); // Get header
        var toggler = $('.navbar-toggler'); // Get menu toggle btn

        // if clicked target is not the menu container/decendent of menu container, toggler or header close
        if (
          !menu.has(target).length > 0 &&
          !menu.is(target) &&
          !header.is(e.target) &&
          !toggler.is(e.target)
        ) {
          $('#pagesNav').removeClass('kong-navbar-collapse--expand');
          $('button[data-toggle="kong-expand"]').removeClass('active');
        }
      }

      // Close mobile menu when clicked outside
      $(window).on('click', function(e) {
        closeMenu(e);
      });

      // Close mobile menu on esc click
      $(document).keyup(function(e) {
        if (e.keyCode == 27) {
          closeMenu(e);
        }
      });

      // Offscreen Subnav Triggers

      jQuery('.trigger').click(function() {
        jQuery(this)
          .next()
          .addClass('active');
        jQuery('.trigger, .remove').addClass('active');
        jQuery('.kong-navbar-collapse_section').addClass('shift');
      });
      jQuery('.back').click(function() {
        jQuery('.kong-navbar-collapse_section').removeClass('shift');
        jQuery('.subnav, .trigger, .remove').removeClass('active');
      });
    </script>
    <script>
      // trigger overlay on nav hover
      jQuery('.kong-navbar-dropdown').hover(
        function(e) {
          jQuery('.overlay').addClass('active');
        }, // over
        function(e) {
          jQuery('.overlay').removeClass('active');
        } // out
      );
      jQuery(window).load(function() {
        jQuery('#oss_subnav').addClass('expand');
      });
      jQuery(window).scroll(function() {
        var scroll = jQuery(window).scrollTop();

        if (scroll >= 5) {
          jQuery('#oss_subnav').addClass('collapsed');
        } else {
          jQuery('#oss_subnav').removeClass('collapsed');
        }
      });
    </script>
  </body>

  
</html>
